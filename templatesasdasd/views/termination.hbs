
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>ScaleEdge</title>
    <link rel="stylesheet" href="/assets/vendors/mdi/css/materialdesignicons.min.css">
    <link rel="stylesheet" href="/assets/vendors/css/vendor.bundle.base.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://kit.fontawesome.com/yourcode.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://unpkg.com/sweetalert/dist/sweetalert.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="shortcut icon" href="/assets/images/favicon.ico" />
</head>

<body>
    <div class="container-scroller">
        {{>topbar}}
        <div class="container-fluid page-body-wrapper">
            {{#if (eq userGroup "admin")}}
            {{> sidebar}}
            {{else}}
            {{> attendanceSidebar}}
            {{/if}}
            <div class="main-panel">
                <div class="content-wrapper">
                    <div class="page-header">
                        <h3 class="page-title">
                            <span class="page-title-icon bg-gradient-primary text-white me-2">
                                <i class="mdi mdi-arrow-left" onclick="goBack()" title="Back"></i>
                <script>
                  function goBack() {
                    window.history.back();
                  }
                </script>
                            </span> Generate Termination Letter
                        </h3>
                        {{!-- <nav aria-label="breadcrumb" class="d-flex">
                            <ol class="breadcrumb">
                                <li class="">
                                    <button>Download Format</button>
                                </li>
                            </ol>
                        </nav> --}}
                    </div>
                    <div class="row">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-body">
                                    <form class="form-sample" id="formData" onsubmit="generateOfferLetter(event)">
                                        <div class="row">
                                            <div class="col-md-12">
                                                <div class="form-group row">
                                                    <label class="col-sm-3 col-form-label">Name</label>
                                                    <div class="col-sm-9">
                                                        <input type="text" class="form-control" id="user_name"
                                                            name="user_name" value="{{user.user_name}}" {{#ifEquals userGroup 'user' }}
                                                            readonly {{/ifEquals}} />
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        {{!-- <div class="row">
                                            <div class="col-md-6">

                                            </div> --}}
                                            {{!-- <div class="col-md-6">
                                                <div class="form-group row">
                                                    <label class="col-sm-3 col-form-label">E-mail</label>
                                                    <div class="col-sm-9">
                                                        <input type="email" id="user_email" name="user_email"
                                                            class="form-control" />
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-group row">
                                                    <label class="col-sm-3 col-form-label">Mobile</label>
                                                    <div class="col-sm-9">
                                                        <input class="form-control" id="mobile" type="number"
                                                            name="mobile" />
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group row">
                                                    <label class="col-sm-3 col-form-label">Position</label>
                                                    <div class="col-sm-9">
                                                        <input class="form-control" type="text" id="position"
                                                            name="position" />
                                                    </div>
                                                </div>
                                            </div>
                                        </div> --}}
                                        <button type="submit" id="submit-btn"
                                            class="btn btn-gradient-primary me-2">Submit</button>
                                        <button class="btn btn-light" onclick="goBack()">Cancel</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>

        </div>
    </div>

    <script src="/assets/vendors/js/vendor.bundle.base.js"></script>
    <script src="/assets/vendors/chart.js/Chart.min.js"></script>
    <script src="/assets/js/jquery.cookie.js" type="text/javascript"></script>
    <script src="/assets/js/off-canvas.js"></script>
    <script src="/assets/js/hoverable-collapse.js"></script>
    <script src="/assets/js/misc.js"></script>
    <script src="/assets/js/dashboard.js"></script>
    <script src="/assets/js/todolist.js"></script>
</body>

</html>

<!-- Add this script tag to include mammoth -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.0.1/mammoth.browser.min.js"></script>

<!-- Your existing HTML code -->

<script>
    function goBack() {
        window.history.back();
    }

    function generateOfferLetter(event) {
        event.preventDefault();

        const userName = document.getElementById('user_name').value.trim();

        if (!userName) {
            Swal.fire({
                icon: 'error',
                title: 'Oops...',
                text: 'Please fill Name!',
            });
            return;
        }

        // Load the Word template
        const templatePath = 'termination.docx'; // Replace with the correct path
        fetch(templatePath)
            .then(response => response.blob())
            .then(templateBlob => {
                // Read the Word template as text
                const reader = new FileReader();
                reader.onload = function () {
                    const templateText = reader.result;

                    // Replace placeholders with data
                    const replacedText = templateText.replace(/\${userName}/g, userName);

                    // Convert the modified text back to a Blob
                    const modifiedBlob = new Blob([replacedText], { type: 'application/msword' });

                    // Display the generated offer letter in a new window
                    const printWindow = window.open('', '_blank');
                    const url = URL.createObjectURL(modifiedBlob);
                    printWindow.location.href = url;
                };
                reader.readAsText(templateBlob);
            });
    }
</script>
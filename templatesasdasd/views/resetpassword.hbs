<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.4.2/mdb.min.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <!-- Add this in your HTML head -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@10">

    <!-- ... Your existing HTML ... -->

    <style>
        .success-toast {
            background-color: lightgreen;
            color: black;
            animation: toastAnimation 2s ease-in-out;
        }

        .error-toast {
            background-color: lightcoral;
            animation: toastAnimation 2s ease-in-out;
        }

        @keyframes toastAnimation {
            0% {
                opacity: 0;
                transform: translateY(100%);
            }

            20% {
                opacity: 1;
                transform: translateY(0);
            }

            80% {
                opacity: 1;
                transform: translateY(0);
            }

            100% {
                opacity: 0;
                transform: translateY(100%);
            }
        }
    </style>
</head>

<body>
    <section class="background-radial-gradient overflow-hidden">
        <style>
            {
                    {
                    !-- .background-radial-gradient {
                        background-color: hsl(218, 41%, 15%);
                        background-image: radial-gradient(650px circle at 0% 0%,
                                hsl(218, 41%, 35%) 15%,
                                hsl(218, 41%, 30%) 35%,
                                hsl(218, 41%, 20%) 75%,
                                hsl(218, 41%, 19%) 80%,
                                transparent 100%),
                            radial-gradient(1250px circle at 100% 100%,
                                hsl(218, 41%, 45%) 15%,
                                hsl(218, 41%, 30%) 35%,
                                hsl(218, 41%, 20%) 75%,
                                hsl(218, 41%, 19%) 80%,
                                transparent 100%);
                    }

                    --
                }
            }

            #radius-shape-1 {
                height: 220px;
                width: 220px;
                top: -60px;
                left: -130px;
                background: radial-gradient(#44006b, #ad1fff);
                overflow: hidden;
            }

            #radius-shape-2 {
                border-radius: 38% 62% 63% 37% / 70% 33% 67% 30%;
                bottom: -60px;
                right: -110px;
                width: 300px;
                height: 300px;
                background: radial-gradient(#44006b, #ad1fff);
                overflow: hidden;
            }

            .bg-glass {
                background-color: hsla(0, 0%, 100%, 0.9) !important;
                backdrop-filter: saturate(200%) blur(25px);
            }

            @media (max-width: 767px) {

                .background-radial-gradient {
                    overflow-x: hidden;
                    overflow-y: auto;
                }

                .reverse-order {
                    flex-direction: column-reverse;
                }
            }
        </style>
        <div class="container px-4 px-md-5 text-center text-lg-start my-5">
            <div class="row gx-lg-5 align-items-center mb-5 reverse-order" style="margin-top: 171px;">
                <div class="col-lg-6 mb-5 mb-lg-0" style="z-index: 10">
                    <h1 class="my-5 display-5 fw-bold ls-tight" style="color: hsl(218, 81%, 35%)">
                        ScaleEdge Solution <br>
                        <span style="color: hsl(218, 81%, 75%)">IT Services Provider</span>
                    </h1>
                    <p class="mb-4 opacity-70" style="color: hsl(218, 81%, 25%)">
                        We specialize in IT services and offer a state-of-the-art Face Attendance System for businesses.
                        Our solution ensures accurate and efficient attendance tracking using facial recognition
                        technology.
                        Contact us to learn more about how we can help your business streamline attendance management.
                    </p>
                </div>

                <div class="col-lg-6 mb-5 mb-lg-0 position-relative">
                    <div id="radius-shape-1" class="position-absolute rounded-circle shadow-5-strong"></div>
                    <div id="radius-shape-2" class="position-absolute shadow-5-strong"></div>

                    <div class="card bg-glass">
                        <div style="display: flex; justify-content: center; align-items: center;">
                            <img src="/images/logo.png" class="mx-5" alt="" style="height: 30vh; width: 35vh;">
                        </div>
                        <div class="card-body px-4 py-0 mb-0  px-md-5" style="/* margin-top: 41px; */">
                            <form class="sign-in-form" method="post" action="/passwordChangeByOtp">
                                <div class="row">
                                    <div class="col-md-9">
                                        <div class="form-outline mb-4">
                                            <input style="padding: 0.65rem 0.75rem;" type="email" id="email"
                                                name="email" class="form-control">
                                            <label class="form-label" for="email" style="margin-left: 0px;">Email
                                                address</label>
                                        </div>
                                    </div>
                                    <div class="col-md-3 mt-1">
                                        <!-- Send OTP Button -->
                                        <button type="button" id="send-otp-btn" class="btn btn-primary mb-3"
                                            onclick="sendOTP()">Send OTP</button>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-9">
                                        <!-- OTP Input Field (Initially Hidden) -->
                                        <div class="form-outline mb-4" id="otp-field" style="display: none;">
                                            <input style="padding: 0.65rem 0.75rem;" type="text" id="otp" name="otp"
                                                class="form-control">
                                            <label class="form-label" for="otp" style="margin-left: 0px;">Enter
                                                OTP</label>
                                        </div>
                                    </div>
                                    <div class="col-md-3 mt-1">
                                        <!-- Verify OTP Button -->
                                        <button type="button" id="verify-otp-btn" class="btn btn-primary mb-3"
                                            style="display: none;" onclick="verifyOTP()">Verify OTP</button>
                                    </div>
                                </div>

                                <!-- Next Button (Initially Hidden) -->
                                <button type="submit" id="next-btn" class="btn btn-primary btn-block mb-5"
                                    style="display: none;">Next</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
</body>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.4.2/mdb.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
<script>
    function sendOTP() {
        const email = document.getElementById("email").value;

        // Fetch API to send OTP
        fetch('/sendOTP', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ email: email })
        })
            .then(response => response.json())
            .then(data => {
                // On successful response, show OTP field and verify OTP button
                document.getElementById("otp-field").style.display = "block";
                document.getElementById("verify-otp-btn").style.display = "block";

                // Store OTP in local storage
                localStorage.setItem("otp", data.otp);

                // SweetAlert2 success message
                Swal.fire({
                    icon: 'success',
                    title: 'OTP Sent',
                    text: 'Please check your email for the OTP.',
                });
            })
            .catch(error => {
                console.error('Error:', error);
                // SweetAlert2 error message
                Swal.fire({
                    icon: 'error',
                    title: 'Failed to Send OTP',
                    text: 'Please try again.',
                });
            });
    }

    function verifyOTP() {
        const enteredOTP = document.getElementById("otp").value;
        const storedOTP = localStorage.getItem("otp");

        if (enteredOTP === storedOTP) {
            // Redirect to password reset page with email as query parameter
            const email = document.getElementById("email").value;
            window.location.href = `/password?email=${email}`;
        } else {
            // SweetAlert2 error message for wrong OTP
            Swal.fire({
                icon: 'error',
                title: 'Wrong OTP!',
                text: 'Please try again.',
            });
        }
    }
</script>

</html>

{{!--
<script>
    async function validateEmail(event) {
        event.preventDefault();

        // Get the email input value
        const email = document.getElementById('email').value;

        try {
            // Send a POST request to the server
            const response = await fetch('/check_email_reset', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ email }),
            });

            const data = await response.json();

            // Check if the email exists
            if (data.exists) {
                // Email exists, redirect to the password page
                window.location.href = '/password?email=' + encodeURIComponent(email);
            } else {
                // Email does not exist, show SweetAlert message
                Swal.fire({
                    icon: 'error',
                    title: 'Email Not Verified',
                    text: 'The provided email is not verified.',
                });
            }
        } catch (error) {
            console.error('Error:', error);
            // Handle other errors if needed
        }
    }
</script> --}}
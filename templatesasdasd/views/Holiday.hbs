<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ScaleEdge</title>
    <link rel="stylesheet" href="/assets/vendors/mdi/css/materialdesignicons.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <link rel="stylesheet" href="/assets/vendors/css/vendor.bundle.base.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://kit.fontawesome.com/yourcode.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://unpkg.com/sweetalert/dist/sweetalert.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="shortcut icon" href="/assets/images/favicon.ico" />
    <meta name="viewport" content=" width=" 1024", initial-scale=1, user-scalable=yes">

</head>

<body>
    <div class="container-scroller">
        {{>topbar}}
        <div class="container-fluid page-body-wrapper">
            {{>sidebar}}
            <div class="main-panel">
                <div class="content-wrapper">
                    <div class="page-header">

                        <h3 class="page-title">
                            <span class="page-title-icon bg-gradient-primary text-white me-2">
                                <i class="mdi mdi-arrow-left" onclick="goBack()" title="Back"></i>
                <script>
                  function goBack() {
                    window.history.back();
                  }
                </script>
                            </span> Holiday
                        </h3>
                        <nav aria-label="breadcrumb">
                            <ul class="breadcrumb">
                                <li class="breadcrumb-item active" aria-current="page">
                                    <span></span><a id="open-calendar"><i class="fa-solid fa-calendar-days"></i></a>
                                </li>
                            </ul>
                        </nav>
                    </div>
                    <div class="row">
                        <div class="col-md-10 grid-margin stretch-card">
                            <div class="card">
                                <div class="card-body">
                                    <div class="col-md-8">
                                        <div class="form-group row">
                                            <label class="col-sm-3 col-form-label fw-bolder">Select Option</label>
                                            <div class="col-sm-9" style="position: relative; right: 37px;">
                                                <select id="optionSelect" class="form-select "
                                                    style="border: 1px solid #ebedf2; font-family: 'ubuntu-regular', sans-serif;  padding: 10px; border-radius: 10px; font-size: 0.8125rem; padding:10px; border-radius:14px">
                                                    <option>
                                                        <i class="fa-solid fa-plus"></i> <span
                                                            style="margin: 10px;">Select
                                                            Holiday</span>
                                                    </option>
                                                    <option value="addHolidayButton">
                                                        <i class="fa-solid fa-plus"></i> <span style="margin: 10px;">Add
                                                            Event</span>
                                                    </option>
                                                    <option value="addHalfdayButton">
                                                        <i class="fa-solid fa-plus"></i> <span style="margin: 10px;">Add
                                                            Halfday</span>
                                                    </option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="holidayForm" style="display:none;">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <input type="date" id="holidayDate" name="date" class="form-control"
                                                    placeholder="Select a date" style="border-radius:10px ;">
                                            </div>
                                            <div class="col-md-6 ">
                                                <input type="text" id="holidayRemarks" name="remarks"
                                                    class="form-control" placeholder="Enter remarks"
                                                    style="border-radius:10px ;">
                                            </div>

                                        </div>
                                        <div class="col-md-3 mt-3">
                                            <button id="saveHolidayButton"
                                                class="btn btn-gradient-primary btn-rounded btn-fw"
                                                style="height: fit-content;">
                                                <i class="fa-solid fa-save"></i> <span style="margin: 10px;">Save</span>
                                            </button>
                                        </div>
                                    </div>
                                    <div id="halfdayForm" style="display: none;">
                                        <div class="row">
                                            <div class="col-md-6">
                                                <input type="date" id="halfdayDate" name="date" class="form-control"
                                                    placeholder="Select a date" style="border-radius:10px ;">
                                            </div>

                                        </div>
                                        <div class="col-md-3 mt-3">
                                            <button id="saveHalfdayButton"
                                                class="btn btn-gradient-primary btn-rounded btn-fw"
                                                style="height: fit-content;">
                                                <i class="fa-solid fa-save"></i> <span style="margin: 10px;">Save</span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-12 grid-margin stretch-card" >
                            <div class="card" >
                                <div class="card-body">
                                    {{!-- <button id="addHolidayButton" class="btn btn-gradient-primary"
                                        style="height: fit-content;float: inline-end;">
                                        <i class="fa-solid fa-plus"></i> <span style="margin: 10px;">Add Event</span>
                                    </button> --}}
                                    {{!-- <div class="col-md-6">
                                        <div class="form-group row">
                                            <label class="col-sm-3 col-form-label">Select Option</label>
                                            <div class="col-sm-9">
                                                <select id="optionSelect" class="form-select"
                                                    style="border: 1px solid #ebedf2; font-family: 'ubuntu-regular', sans-serif; font-size: 0.8125rem;">
                                                    <option>
                                                        <i class="fa-solid fa-plus"></i> <span
                                                            style="margin: 10px;">Select Option</span>
                                                    </option>
                                                    <option value="addHolidayButton">
                                                        <i class="fa-solid fa-plus"></i> <span style="margin: 10px;">Add
                                                            Event</span>
                                                    </option>
                                                    <option value="addHalfdayButton">
                                                        <i class="fa-solid fa-plus"></i> <span style="margin: 10px;">Add
                                                            Halfday</span>
                                                    </option>
                                                </select>
                                            </div>
                                        </div>
                                    </div> --}}
                                    <iframe style="border-width:0" width="950" height="5" frameborder="0"
                                        scrolling="no"></iframe>
                                    <div id="calendar-container" style="display: none;">
                                        <iframe id="google-calendar"
                                            src="https://calendar.google.com/calendar/embed?height=600&wkst=1&bgcolor=%23ffffff&ctz=UTC&showCalendars=1&showTabs=1&showPrint=1&showNav=1&src=YXNoaXNoYmhhcmdhdjExMDcyMDAzQGdtYWlsLmNvbQ&src=ODg5NzNjMzkyMTczNGQ4MzhmNTQwYjFjODAzNTc9ZTViNTQyYWM1ZmE1Yj73MmQ2MDI3MTZhZjRiZmM0OWNmNUBncm91cC5jYWxlbmRhci5nb29nbGUuY29t&src=YWRkcmVzc2Jvb2sjY29udGFjdHNAZ3JvdXAudi5jYWxlbmRhci5nb29nbGUuY29t&src=ZW4uaW5kaWFuI2hvbGlkYXlAZ3JvdXAudi5jYWxlbmRhci5nb29nbGUuY29t&color=%23039BE5&color=%238E24AA&color=%2333B679&color=%230B8043"
                                            style="border-width:0" width="650" height="600" frameborder="0"
                                            scrolling="no">
                                        </iframe>
                                    </div>
                                    <div class="table-responsive mb-4 mt-5" style="max-height: 400px; overflow: auto; ">
                                        <a href="" class="fw-bold"
                                            style="color: #dc4c64!important; text-decoration:underline; font-size:20px">Holiday
                                            List</a>
                                        <table id="userTable" class="table table-bordered mt-3">
                                            <thead>
                                                <tr>
                                                    <th scope="col" class="text-center">Id</th>
                                                    <th scope="col" class="text-center">Month</th>
                                                    <th scope="col" class="text-center">Year</th>
                                                    <th scope="col" class="text-center">Date</th>
                                                    <th scope="col" class="text-center">Remarks</th>
                                                    <th scope="col" class="text-center">Action</th>
                                                </tr>
                                            </thead>
                                            <tbody id="userTableBody">
                                                {{#each holidayData}}
                                                <tr>
                                                    <td scope="row" class="text-center">{{ capitalizeFirst this.Id}}
                                                    </td>
                                                    <td class="text-center">{{capitalizeFirst this.Month}}</td>
                                                    <td class="text-center">{{ capitalizeFirst this.Year}}</td>
                                                    <td class="text-center">{{capitalizeFirst this.Date}}</td>
                                                    <td class="text-center">{{capitalizeFirst this.Remarks}}</td>
                                                    <td class="text-center">
                                                        <a href="/editHoliday/{{this.Id}}" class="btn"
                                                            style="padding: initial;">
                                                            <i class="fa-solid fa-pencil"
                                                                style="font-size: 20px; padding:initial"></i>
                                                        </a>
                                                        <a onclick="deleteUser('{{this.Id}}')" class="btn "
                                                            style="padding: initial;">
                                                            <i class="fa-solid fa-trash-alt"
                                                                style="font-size: 20px; padding:initial ; color:red"></i>
                                                        </a>
                                                    </td>
                                                </tr>
                                                {{/each}}
                                            </tbody>
                                        </table>
                                    </div>
                                    <div class="table-responsive mb-4 mt-5" style="max-height: 400px; overflow: auto;">
                                        <a href="" class="fw-bold"
                                            style="color: #dc4c64!important; text-decoration:underline; font-size:20px">Halfday
                                            List</a>
                                        <table id="halfdayTable" class="table table-bordered mt-3">
                                            <thead>
                                                <tr>
                                                    <th scope="col" class="text-center">Id</th>
                                                    <th scope="col" class="text-center">Month</th>
                                                    <th scope="col" class="text-center">Year</th>
                                                    <th scope="col" class="text-center">Date</th>
                                                    <th scope="col" class="text-center">Action</th>
                                                </tr>
                                            </thead>
                                            <tbody id="halfdayTableBody">
                                                {{#each halfdayData}}
                                                <tr>
                                                    <td scope="row" class="text-center">{{ capitalizeFirst this.Id}}
                                                    </td>
                                                    <td class="text-center">{{capitalizeFirst this.Month}}</td>
                                                    <td class="text-center">{{ capitalizeFirst this.Year}}</td>
                                                    <td class="text-center">{{capitalizeFirst this.Date}}</td>
                                                    <td class="text-center">
                                                        <a href="/editHalfday/{{this.Id}}" class="btn"
                                                            style="padding: initial;">
                                                            <i class="fa-solid fa-pencil"
                                                                style="font-size: 20px; padding:initial"></i>
                                                        </a>
                                                        <a onclick="deleteHoliday('{{this.Id}}')" class="btn "
                                                            style="padding: initial;">
                                                            <i class="fa-solid fa-trash-alt"
                                                                style="font-size: 20px; padding:initial ; color:red"></i>
                                                        </a>
                                                    </td>
                                                </tr>
                                                {{/each}}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="/assets/js/jquery-2.1.1.min.js"></script>
    <script src="/assets/js/face-api.js"></script>
    <script src="/assets/js/faceSystem2.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <script src="/assets/vendors/js/vendor.bundle.base.js"></script>
    <script src="/assets/vendors/chart.js/Chart.min.js"></script>
    <script src="/assets/js/jquery.cookie.js" type="text/javascript"></script>
    <script src="/assets/js/off-canvas.js"></script>
    <script src="/assets/js/hoverable-collapse.js"></script>
    <script src="/assets/js/misc.js"></script>
    <script src="/assets/js/dashboard.js"></script>
    <script src="/assets/js/todolist.js"></script>
</body>

</html>
<script>
    document.getElementById('optionSelect').addEventListener('change', function () {
        var selectedOption = this.value;

        if (selectedOption === 'addHolidayButton') {
            document.getElementById('holidayForm').style.display = 'block';
        } else {
            document.getElementById('holidayForm').style.display = 'none';
        }
        if (selectedOption === 'addHalfdayButton') {
            document.getElementById('halfdayForm').style.display = 'block';
        } else {
            document.getElementById('halfdayForm').style.display = 'none';
        }
    });



    document.getElementById('saveHolidayButton').addEventListener('click', function () {
        var date = document.getElementById('holidayDate').value;
        var remarks = document.getElementById('holidayRemarks').value;

        // Extract month and year from the selected date
        var selectedDate = new Date(date);
        var month = selectedDate.getMonth() + 1; // Month is 0-indexed, so add 1
        var year = selectedDate.getFullYear();

        // Send the data to the server (you will need to implement a server-side API for this)
        fetch('/saveHoliday', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                month: month,
                year: year,
                date: date,
                remarks: remarks
            })
        }).then(response => {
            // Handle the response from the server
            if (response.status === 200) {
                // Clear input fields or hide the form
                document.getElementById('holidayDate').value = '';
                document.getElementById('holidayRemarks').value = '';
                document.getElementById('holidayForm').style.display = 'none';

                // Show a success message with SweetAlert
                Swal.fire({
                    icon: 'success',
                    title: 'Success!',
                    text: 'Holiday data saved successfully',
                });
            } else {
                // Show an error message with SweetAlert
                Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: 'Failed to save holiday data',
                });
            }
        });
    });
    function deleteUser(id) {
        Swal.fire({
            title: 'Are you sure?',
            text: 'You won\'t be able to revert this!',
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#d33',
            cancelButtonColor: '#3085d6',
            confirmButtonText: 'Yes, delete it!',
            cancelButtonText: 'Cancel'
        }).then((result) => {
            if (result.isConfirmed) {
                fetch(`/deleteHoliday/${id}`, {
                    method: 'DELETE'
                })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            location.reload();
                        } else {
                            Swal.fire('Error', 'An error occurred while deleting the holiday.', 'error');
                        }
                    })
                    .catch(error => {
                        console.error('Delete error:', error);
                        Swal.fire('Error', 'An error occurred while deleting the holiday.', 'error');
                    });
            }
        });
    }

    function deleteHoliday(id) {
        Swal.fire({
            title: 'Are you sure?',
            text: 'You won\'t be able to revert this!',
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#d33',
            cancelButtonColor: '#3085d6',
            confirmButtonText: 'Yes, delete it!',
            cancelButtonText: 'Cancel'
        }).then((result) => {
            if (result.isConfirmed) {
                fetch(`/deleteHalfday/${id}`, {
                    method: 'DELETE'
                })
                    .then(response => response.json())
                    .then(data => {
                        if (data.success) {
                            location.reload();
                        } else {
                            Swal.fire('Error', 'An error occurred while deleting the holiday.', 'error');
                        }
                    })
                    .catch(error => {
                        console.error('Delete error:', error);
                        Swal.fire('Error', 'An error occurred while deleting the holiday.', 'error');
                    });
            }
        });
    }

</script>

<style>
    #holidayForm {
        display: block;
        margin-bottom: 14px;
        flex-wrap: wrap;
    }



    #halfdayForm {
        display: block;
        margin-bottom: 14px;
        flex-wrap: wrap;
    }
</style>
<script>
    document.getElementById('open-calendar').addEventListener('click', function () {
        var calendarContainer = document.getElementById('calendar-container');
        if (calendarContainer.style.display === 'none' || calendarContainer.style.display === '') {
            calendarContainer.style.display = 'block';
        } else {
            calendarContainer.style.display = 'none';
        }
    });
</script>
<script>
    document.getElementById('saveHalfdayButton').addEventListener('click', function () {
        var date = document.getElementById('halfdayDate').value;

        // Extract month and year from the selected date
        var selectedDate = new Date(date);
        var month = selectedDate.getMonth() + 1; // Month is 0-indexed, so add 1
        var year = selectedDate.getFullYear();

        fetch('/saveHalfday', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                month: month,
                year: year,
                date: date
            })
        }).then(response => {
            // Handle the response from the server
            if (response.status === 200) {
                // Clear input fields or hide the form
                document.getElementById('halfdayDate').value = '';
                document.getElementById('halfdayForm').style.display = 'none';

                // Show a success message with SweetAlert
                Swal.fire({
                    icon: 'success',
                    title: 'Success!',
                    text: 'Halfday data saved successfully',
                });
            } else {
                // Show an error message with SweetAlert
                Swal.fire({
                    icon: 'error',
                    title: 'Error',
                    text: 'Failed to save Halfday data',
                });
            }
        });
    });
</script>